{"version":3,"file":"Media3DRenderer-ad280250.js","sources":["../../src/components/Media3DRenderer.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState, useMemo } from 'react';\nimport { Canvas, useFrame, useThree } from '@react-three/fiber';\nimport { OrbitControls, useTexture, PerspectiveCamera } from '@react-three/drei';\nimport * as THREE from 'three';\n\ninterface TensorData {\n  objectUrl: string;\n  dimensions: { width: number; height: number; depth: number };\n  vertices: number;\n}\n\ninterface Media3DPlaneProps {\n  textureUrl: string;\n  dimensions: { width: number; height: number; depth: number };\n  isVideo?: boolean;\n}\n\nconst Media3DPlane: React.FC<Media3DPlaneProps> = ({ textureUrl, dimensions, isVideo }) => {\n  const meshRef = useRef<THREE.Mesh>(null);\n  const [videoTexture, setVideoTexture] = useState<THREE.VideoTexture | null>(null);\n  const [imageTexture, setImageTexture] = useState<THREE.Texture | null>(null);\n\n  useEffect(() => {\n    if (isVideo) {\n      const video = document.createElement('video');\n      video.src = textureUrl;\n      video.crossOrigin = 'anonymous';\n      video.loop = true;\n      video.muted = true;\n      video.playsInline = true;\n      video.play().catch(() => {});\n      \n      const texture = new THREE.VideoTexture(video);\n      texture.minFilter = THREE.LinearFilter;\n      texture.magFilter = THREE.LinearFilter;\n      setVideoTexture(texture);\n\n      return () => {\n        video.pause();\n        video.src = '';\n        texture.dispose();\n      };\n    } else {\n      const loader = new THREE.TextureLoader();\n      loader.load(textureUrl, (texture) => {\n        texture.minFilter = THREE.LinearFilter;\n        texture.magFilter = THREE.LinearFilter;\n        setImageTexture(texture);\n      });\n    }\n  }, [textureUrl, isVideo]);\n\n  useFrame((state) => {\n    if (meshRef.current) {\n      meshRef.current.rotation.y = Math.sin(state.clock.elapsedTime * 0.5) * 0.1;\n      meshRef.current.position.y = Math.sin(state.clock.elapsedTime * 0.8) * 0.05;\n    }\n  });\n\n  const texture = isVideo ? videoTexture : imageTexture;\n  if (!texture) return null;\n\n  return (\n    <mesh ref={meshRef} castShadow receiveShadow>\n      <boxGeometry args={[dimensions.width, dimensions.height, dimensions.depth]} />\n      <meshStandardMaterial \n        map={texture} \n        side={THREE.DoubleSide}\n        metalness={0.1}\n        roughness={0.3}\n      />\n      <mesh position={[0, 0, -dimensions.depth / 2 - 0.01]}>\n        <planeGeometry args={[dimensions.width, dimensions.height]} />\n        <meshStandardMaterial \n          color=\"#00f3ff\" \n          emissive=\"#00f3ff\"\n          emissiveIntensity={0.2}\n          transparent\n          opacity={0.3}\n          side={THREE.BackSide}\n        />\n      </mesh>\n    </mesh>\n  );\n};\n\ninterface FlowerOfLifeFrameProps {\n  size: number;\n}\n\nconst FlowerOfLifeFrame: React.FC<FlowerOfLifeFrameProps> = ({ size }) => {\n  const groupRef = useRef<THREE.Group>(null);\n  const PHI = 1.618033988749895;\n  \n  useFrame((state) => {\n    if (groupRef.current) {\n      groupRef.current.rotation.z = state.clock.elapsedTime * 0.1;\n    }\n  });\n\n  const circles = useMemo(() => {\n    const result: JSX.Element[] = [];\n    const radius = size * 0.2;\n    const angles = [0, 60, 120, 180, 240, 300];\n    \n    result.push(\n      <mesh key=\"center\" position={[0, 0, -0.1]}>\n        <ringGeometry args={[radius - 0.01, radius, 64]} />\n        <meshBasicMaterial color=\"#00f3ff\" transparent opacity={0.3} />\n      </mesh>\n    );\n    \n    angles.forEach((angle, i) => {\n      const x = radius * Math.cos((angle * Math.PI) / 180);\n      const y = radius * Math.sin((angle * Math.PI) / 180);\n      result.push(\n        <mesh key={`outer-${i}`} position={[x, y, -0.1]}>\n          <ringGeometry args={[radius - 0.01, radius, 64]} />\n          <meshBasicMaterial color=\"#4caf50\" transparent opacity={0.2} />\n        </mesh>\n      );\n    });\n    \n    return result;\n  }, [size]);\n\n  return (\n    <group ref={groupRef}>\n      {circles}\n    </group>\n  );\n};\n\ninterface Media3DRendererProps {\n  tensorData: TensorData;\n  isVideo?: boolean;\n  size?: 'small' | 'medium' | 'large';\n  showFrame?: boolean;\n  interactive?: boolean;\n}\n\nconst Media3DRenderer: React.FC<Media3DRendererProps> = ({ \n  tensorData, \n  isVideo = false,\n  size = 'medium',\n  showFrame = true,\n  interactive = true\n}) => {\n  const sizeMap = {\n    small: { width: 120, height: 90 },\n    medium: { width: 200, height: 150 },\n    large: { width: 320, height: 240 }\n  };\n  \n  const dimensions = sizeMap[size];\n\n  return (\n    <div \n      className=\"relative rounded-lg overflow-hidden border border-[#00f3ff]/30 bg-black/50\"\n      style={{ width: dimensions.width, height: dimensions.height }}\n    >\n      <Canvas shadows>\n        <PerspectiveCamera makeDefault position={[0, 0, 2.5]} fov={50} />\n        <ambientLight intensity={0.4} />\n        <pointLight position={[5, 5, 5]} intensity={0.8} castShadow />\n        <pointLight position={[-5, -5, 5]} intensity={0.3} color=\"#00f3ff\" />\n        <spotLight \n          position={[0, 5, 5]} \n          angle={0.3} \n          penumbra={0.5} \n          intensity={0.5}\n          castShadow\n        />\n        \n        {showFrame && <FlowerOfLifeFrame size={2} />}\n        \n        <Media3DPlane \n          textureUrl={tensorData.objectUrl}\n          dimensions={tensorData.dimensions}\n          isVideo={isVideo}\n        />\n        \n        {interactive && (\n          <OrbitControls \n            enableZoom={false} \n            enablePan={false}\n            minPolarAngle={Math.PI / 3}\n            maxPolarAngle={Math.PI * 2 / 3}\n          />\n        )}\n      </Canvas>\n      \n      <div className=\"absolute top-1 right-1 flex items-center gap-1 px-2 py-0.5 bg-black/60 rounded text-[8px] font-mono text-[#00f3ff]/80\">\n        <span className=\"w-1.5 h-1.5 bg-[#00f3ff] rounded-full animate-pulse\" />\n        3D_TENSOR\n      </div>\n      \n      <div className=\"absolute bottom-1 left-1 text-[7px] font-mono text-[#4caf50]/60\">\n        {tensorData.dimensions.width.toFixed(2)} Ã— {tensorData.dimensions.height.toFixed(2)}\n      </div>\n    </div>\n  );\n};\n\nexport default Media3DRenderer;\n\nexport const MediaPreview: React.FC<{\n  url: string;\n  type: 'image' | 'video';\n  fileName?: string;\n  className?: string;\n}> = ({ url, type, fileName, className = '' }) => {\n  if (type === 'video') {\n    return (\n      <div className={`relative ${className}`}>\n        <video \n          src={url} \n          controls \n          className=\"max-w-full max-h-48 rounded border border-[#00f3ff]/20\"\n          preload=\"metadata\"\n        />\n        {fileName && (\n          <div className=\"absolute bottom-1 left-1 px-2 py-0.5 bg-black/80 text-[8px] text-[#00f3ff]/80 font-mono rounded\">\n            {fileName}\n          </div>\n        )}\n      </div>\n    );\n  }\n  \n  return (\n    <div className={`relative ${className}`}>\n      <img \n        src={url} \n        alt={fileName || 'Image'} \n        className=\"max-w-full max-h-48 rounded border border-[#00f3ff]/20 object-contain\"\n      />\n      {fileName && (\n        <div className=\"absolute bottom-1 left-1 px-2 py-0.5 bg-black/80 text-[8px] text-[#00f3ff]/80 font-mono rounded\">\n          {fileName}\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":["Media3DPlane","textureUrl","dimensions","isVideo","meshRef","useRef","videoTexture","setVideoTexture","useState","imageTexture","setImageTexture","useEffect","video","texture","THREE.VideoTexture","THREE.LinearFilter","THREE.TextureLoader","useFrame","state","jsx","THREE.DoubleSide","jsxs","THREE.BackSide","FlowerOfLifeFrame","size","groupRef","circles","useMemo","result","radius","angles","angle","i","x","y","Media3DRenderer","tensorData","showFrame","interactive","Canvas","PerspectiveCamera","OrbitControls","MediaPreview","url","type","fileName","className"],"mappings":"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"}